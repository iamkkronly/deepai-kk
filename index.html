<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kaustav Deepsearch AI</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%); /* A softer, pleasing gradient */
      color: #333;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      margin: 0;
      line-height: 1.6;
    }

    .container {
        background-color: #ffffff;
        padding: 30px;
        border-radius: 20px; /* More rounded corners */
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15); /* More pronounced shadow */
        max-width: 900px;
        width: 100%;
        text-align: center;
        box-sizing: border-box;
        margin-top: 20px; /* Add some space from the top */
        margin-bottom: 20px;
    }

    h1 {
      color: #4a235a; /* Deeper heading color */
      margin-bottom: 5px;
      font-weight: 700; /* Bolder */
    }

    .subtitle { /* Added a class for the subtitle */
        color: #7d3c98;
        margin-top: 0;
        margin-bottom: 30px; /* More space below subtitle */
        font-weight: 400;
        font-size: 1.1em;
    }

    .form-group { /* Grouping label and input */
        margin-bottom: 20px;
        text-align: left;
    }

    label {
      font-weight: 600;
      display: block;
      margin-bottom: 8px; /* More space below label */
      color: #5a326a; /* Label color */
    }

    input[type="text"],
    select,
    textarea {
      padding: 14px 18px; /* Increased padding */
      font-size: 17px; /* Slightly larger font */
      border-radius: 10px; /* More rounded */
      border: 1px solid #dcdcdc;
      width: 100%; /* Full width within form-group */
      box-sizing: border-box;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
      background-color: #f8f8f8; /* Light input background */
    }

    input[type="text"]:focus,
    select:focus,
    textarea:focus {
        border-color: #8e44ad; /* Focus color */
        outline: none;
        box-shadow: 0 0 8px rgba(142, 68, 173, 0.3); /* Focus shadow */
        background-color: #fff; /* White background on focus */
    }

    button {
      padding: 14px 30px; /* Larger buttons */
      margin: 15px 8px 10px 8px; /* Adjusted margin */
      font-size: 17px; /* Larger font */
      border-radius: 10px; /* More rounded */
      border: none;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.1s ease, box-shadow 0.3s ease;
      font-weight: 600;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Button shadow */
    }

    button:hover {
      transform: translateY(-3px); /* More pronounced lift */
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15); /* Larger shadow on hover */
    }

    button:active {
        transform: translateY(0);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Reset shadow on click */
    }

    button:first-of-type {
        background: linear-gradient(45deg, #8e44ad, #9b59b6); /* Gradient button */
        color: white;
    }

     button:first-of-type:hover {
        background: linear-gradient(45deg, #9b59b6, #8e44ad); /* Inverse gradient on hover */
     }

    button:last-of-type {
        background-color: #bdc3c7; /* Grey color */
        color: #555;
    }

    button:last-of-type:hover {
        background-color: #aeb6bf; /* Darker grey on hover */
        color: #333;
    }

    .results {
      margin-top: 40px; /* More space */
      text-align: left;
      border-top: 1px solid #eee;
      padding-top: 30px; /* More space */
    }

    .results h2 {
        color: #4a235a;
        margin-top: 0;
        margin-bottom: 20px;
        font-weight: 700;
        border-bottom: 2px solid #e0e0e0; /* Separator line */
        padding-bottom: 10px;
    }

    .results > div {
        background-color: #fefefe; /* Lighter background */
        padding: 20px; /* More padding */
        border-radius: 10px;
        margin-bottom: 20px;
        border: 1px solid #eee;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05); /* Subtle shadow */
        transition: box-shadow 0.2s ease;
    }
    .results > div:hover {
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* More shadow on hover */
    }


    .results a {
        color: #8e44ad; /* Link color */
        text-decoration: none;
        font-weight: 600;
    }

    .results a:hover {
        text-decoration: underline;
    }

    .results p {
        color: #555;
        margin-top: 10px;
        line-height: 1.7;
    }

    hr {
        border: none;
        height: 1px;
        background-color: #e0e0e0;
        margin: 30px 0;
    }

    .loading {
      color: #e67e22; /* Loading color */
      font-weight: bold;
      margin-top: 30px;
      font-size: 1.2em;
      animation: pulse 1.5s infinite ease-in-out; /* Pulsing animation */
    }

    @keyframes pulse {
        0% { opacity: 0.6; }
        50% { opacity: 1; }
        100% { opacity: 0.6; }
    }


    /* Responsive adjustments */
    @media (max-width: 768px) {
        .container {
            padding: 20px;
            border-radius: 15px;
        }

        input[type="text"],
        select,
        textarea {
            font-size: 15px;
            padding: 12px 15px;
        }

        button {
            font-size: 15px;
            padding: 12px 25px;
            margin: 10px 5px;
        }

        .results > div {
            padding: 15px;
        }

        .loading {
            font-size: 1em;
        }
    }

  </style>
</head>
<body>
    <div class="container">
        <h1>Kaustav Deepsearch AI</h1>
        <p class="subtitle">Powered by Kaustav AI</p>

        <div class="form-group">
            <label for="query">Search Query:</label>
            <input type="text" id="query" placeholder="Enter your topic or question...">
        </div>

        <div class="form-group">
            <label for="language">Language:</label>
            <select id="language">
                <option value="English">English</option>
                <option value="Hindi">Hindi</option>
                <option value="Bengali">Bengali</option>
                <option value="Tamil">Tamil</option>
                <option value="Telugu">Telugu</option>
                <option value="Urdu">Urdu</option>
                <option value="Gujarati">Gujarati</option>
                <option value="Spanish">Spanish</option>
                <option value="French">French</option>
                <option value="German">German</option>
            </select>
        </div>

        <div class="form-group">
            <label for="wordLimit">Max Summary Length:</label>
            <select id="wordLimit">
                <option value="500">500 words</option>
                <option value="1000">1000 words</option>
                <option value="5000">5000 words</option>
                <option value="10000">10000 words</option>
                <option value="20000">20000 words</option>
                <option value="40000">40000 words</option>
                <option value="60000">60000 words</option>
                <option value="80000">80000 words</option>
            </select>
        </div>

        <div class="form-group">
            <label for="tone">Summary Tone:</label>
            <select id="tone">
                <option value="neutral">Neutral</option>
                <option value="informal">Informal</option>
                <option value="formal">Formal</option>
                <option value="funny">Funny</option>
                <option value="technical">Technical</option>
            </select>
        </div>

        <div class="form-group">
            <label for="format">Summary Format:</label>
            <select id="format">
                <option value="paragraph">Paragraph</option>
                <option value="bullets">Bullet Points</option>
                <option value="numbered">Numbered List</option>
            </select>
        </div>


        <button onclick="startDeepSearch()">Start DeepSearch</button>
        <button onclick="clearResults()">Clear</button>

        <div class="loading" id="loading" style="display: none;">Loading Google results...</div>
        <div class="results" id="results"></div>
    </div>

    <script>
        // NOTE: Replace with your actual keys in a production environment and handle them securely.
        // These keys are exposed in client-side code and are for demonstration only.
        const GOOGLE_API_KEY = "AIzaSyCrV8RJ-kUj-LCxbqfB1QMa6RsPQ4bM80Y";
        const SEARCH_ENGINE_ID = "735baae6a3cee4779";
        const GEMINI_API_KEY = "AIzaSyAUS24UaK5kfxrfuUCue5zmyX3n3yD7Yek";

        async function startDeepSearch() {
            const query = document.getElementById("query").value.trim();
            const selectedLang = document.getElementById("language").value;
            const wordLimit = parseInt(document.getElementById("wordLimit").value);
            const tone = document.getElementById("tone").value;
            const format = document.getElementById("format").value;

            if (!query) {
                alert("Bhai, type toh kar!");
                return;
            }

            const loading = document.getElementById("loading");
            const resultsDiv = document.getElementById("results");
            resultsDiv.innerHTML = ""; // Clear previous results
            loading.innerText = "Step 1: Google search in progress...";
            loading.style.display = "block";

            let combinedText = "";
            let googleResultsHTML = ""; // To store Google results HTML

            try {
                const googleData = await fetchGoogle(query);

                if (googleData.items && googleData.items.length > 0) {
                    googleResultsHTML += `<h2>Google Search Results:</h2>`;
                    googleData.items.forEach(item => {
                        googleResultsHTML += `
                            <div>
                              <a href="${item.link}" target="_blank"><strong>${item.title}</strong></a>
                              <p>${item.snippet}</p>
                            </div>
                        `;
                        combinedText += `${item.title}\n${item.snippet}\n${item.link}\n\n`;
                    });
                } else {
                     googleResultsHTML += `<h2>Google Search Results:</h2><p>No Google search results found.</p>`;
                }


                resultsDiv.innerHTML += `<hr><h2>AI Summary (${selectedLang}, up to ${wordLimit} words):</h2>`;

                if (combinedText.length > 0) {
                     loading.innerText = `Step 2: Creating ${wordLimit} words AI summary in ${selectedLang}...`;
                     // Sending the whole text for summary
                     const fullPrompt = `Considering the following web content:\n\n${combinedText}\n\nBased *only* on the provided text, summarize the key information relevant to the query "${query}". The summary should be in ${selectedLang} with a ${tone} tone and presented in ${format}. Keep the total summary under ${wordLimit} words.`;

                     const summary = await fetchGeminiSummary(fullPrompt);
                     resultsDiv.innerHTML += `<p>${summary}</p>`; // Add summary first

                } else {
                    resultsDiv.innerHTML += `<p>No content found to summarize.</p>`;
                }

                // Add horizontal rule and Google results AFTER the summary
                resultsDiv.innerHTML += `<hr>`;
                resultsDiv.innerHTML += googleResultsHTML;


            } catch (err) {
                console.error(err);
                alert("Kuch error aaya bhai!");
                resultsDiv.innerHTML += `<p style="color: red;">Error during search or summary generation: ${err.message}</p>`;
            } finally {
                loading.style.display = "none";
            }
        }

        async function fetchGoogle(query) {
            if (!GOOGLE_API_KEY || !SEARCH_ENGINE_ID) {
                 throw new Error("Google API Key or Search Engine ID is missing.");
            }
             // Use todays date if needed, but for general search it's not required here.
             const today = new Date();
             const dateString = today.toISOString().split('T')[0]; // YYYY-MM-DD format

            const url = `https://www.googleapis.com/customsearch/v1?q=${encodeURIComponent(query)}&key=${GOOGLE_API_KEY}&cx=${SEARCH_ENGINE_ID}`;
            const res = await fetch(url);
            if (!res.ok) {
                 const errorDetail = await res.text();
                 throw new Error(`Google Search API error: ${res.status} ${res.statusText} - ${errorDetail}`);
            }
            return await res.json();
        }

        async function fetchGeminiSummary(prompt) {
             if (!GEMINI_API_KEY) {
                 throw new Error("Gemini API Key is missing.");
             }
             const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`;
             const payload = {
                 contents: [{ parts: [{ text: prompt }] }],
                 generationConfig: {
                     maxOutputTokens: Math.min(parseInt(document.getElementById("wordLimit").value) * 2.5, 8192), // Increased estimate, max 8192 for Flash
                     temperature: 0.7,
                     topP: 0.95,
                     topK: 40
                 }
             };

             const res = await fetch(url, {
                 method: "POST",
                 headers: { "Content-Type": "application/json" },
                 body: JSON.stringify(payload)
             });

             if (!res.ok) {
                 const errorDetail = await res.text();
                  throw new Error(`Gemini API error: ${res.status} ${res.statusText} - ${errorDetail}`);
             }

             const data = await res.json();
             if (data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts[0]) {
                 return data.candidates[0].content.parts[0].text;
             } else if (data.promptFeedback && data.promptFeedback.blockReason) {
                 return `Summary blocked due to safety policy: ${data.promptFeedback.blockReason}`;
             } else if (data.error) {
                 return `Gemini API Error: ${data.error.message}`;
             }
             else {
                  console.warn("Gemini API returned unexpected structure:", data);
                 return "Summary fail ho gaya bhai. (Unexpected API response)";
             }
        }

        function clearResults() {
            document.getElementById("query").value = "";
            document.getElementById("results").innerHTML = "";
            document.getElementById("loading").style.display = "none";
        }
    </script>
</body>
</html>
